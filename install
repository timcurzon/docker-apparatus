#!/bin/bash

PROJECTDIR=`pwd`
DEFAULTDIR="/usr/local/bin"
DEFAULTARCH="arm-hf"
INSTALLDRY=true

printf "\n"

echo -n "Specify the absolute install path for project scripts (default is $DEFAULTDIR): "
read INSTALLDIR

echo -n "Specify CPU architecture ([arm-hf|x86-64] default is $DEFAULTARCH): "
read ARCH

# Configure
printf "\nConfiguration...\n\n"

if [ "$INSTALLDIR" = "" ]; then
  INSTALLDIR=$DEFAULTDIR
  echo "- Will use default install dir:" $INSTALLDIR
else
  echo "- Will install scripts into:" $INSTALLDIR
fi

if [ "$ARCH" = "" ]; then
  ARCH=$DEFAULTARCH
fi
echo "- Using CPU architecture:" $ARCH

echo "- Dry will not be installed, CPU architecture not supported"

# Install
printf "\nInstalling...\n\n"

# ... Docker helper scripts
for f in $( ls ./bin ); do
  echo "> Installing $PROJECTDIR/bin/$f into $INSTALLDIR/$f"
  ln -sf $PROJECTDIR/bin/$f $INSTALLDIR/$f
done

# ... moncho/dry
if [ "$INSTALLDRY" = true ]; then
  if [ "$ARCH" = "arm-hf" ] || [ "$ARCH" = "x86-64" ]; then
    echo "> Installing $PROJECTDIR/$ARCH/dry into $INSTALLDIR/dry"
    ln -sf $PROJECTDIR/$ARCH/dry/dry $INSTALLDIR/dry
  fi
fi

printf "\nDone!\n\n"
